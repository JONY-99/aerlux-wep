{% extends "base.html" %}
{% load static i18n %}

{% block content %}






<div class="header">
    <div class="logo">
        <a href="{% url 'home' %}"><img src="{% static 'img/aerlux_logo.jpg' %}" alt="AERLUX logo"></a>
    </div>
    <h1>Aloqaga Chiqing</h1>
    <p class="subtitle">Loyihangiz haqida bizga xabar qoldiring</p>
</div>  


<div class="form-container">
    <form id="contactForm">
        <div class="name-row">
            <div class="form-group">
                <label for="firstName">Ism <span class="required">*</span></label>
                <input type="text" id="firstName" name="firstName" required placeholder="Ali" autocomplete="given-name">
            </div>
            <div class="form-group">
                <label for="lastName">Familiya <span class="required">*</span></label>
                <input type="text" id="lastName" name="lastName" required placeholder="Valiyev"
                    autocomplete="family-name">
            </div>
        </div>

        <div class="form-group">
            <label for="phone">Telefon raqam <span class="required">*</span></label>
            <input type="tel" id="phone" name="phone" required placeholder="+998 90 123 45 67" autocomplete="tel">
        </div>

        <div class="form-group">
            <label for="email">Email <span class="optional">(ixtiyoriy)</span></label>
            <input type="email" id="email" name="email" placeholder="example@gmail.com" autocomplete="email">
        </div>

        <div class="form-group">
            <label for="company">Kompaniya nomi <span class="optional">(ixtiyoriy)</span></label>
            <input type="text" id="company" name="company" placeholder="AERLUX" autocomplete="organization">
        </div>

        <div class="form-group">
            <label for="project">Loyiha haqida batafsil <span class="required">*</span></label>
            <textarea id="project" name="project" required
                placeholder="Qanday loyiha ustida ishlamoqchisiz? Qanday xizmatlar kerak?"></textarea>
        </div>

        <div class="info-note">
            üîí Ma'lumotlaringiz xavfsiz.<br>Biz tez orada siz bilan bog'lanamiz!
        </div>
    </form>
</div>

<div class="submit-section">
    <button type="submit" form="contactForm" class="submit-btn" id="submitBtn">
        <span id="btnText">Yuborish</span>
    </button>
     
     
    <div id="statusMessage" class="status-message"></div>
</div>

<script>
    const form = document.getElementById("contactForm");
    const submitBtn = document.getElementById("submitBtn");
    const btnText = document.getElementById("btnText");
    const statusMessage = document.getElementById("statusMessage");

    form.addEventListener("submit", async (e) => {
        e.preventDefault();

        submitBtn.disabled = true;
        btnText.textContent = 'Yuborilmoqda...';

        const data = Object.fromEntries(new FormData(form));

        try {
            const response = await fetch("{% url 'send' %}", {   // ‚úÖ Django yo‚Äòliga to‚Äòg‚Äòridan-to‚Äòg‚Äòri murojaat
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(data),
            });

            const result = await response.json();

            if (result.ok) {
                statusMessage.textContent = '‚úÖ Yuborildi! Tez orada aloqaga chiqamiz.';
                statusMessage.classList.add('show', 'success');
                form.reset();

                setTimeout(() => {
                    window.location.href = "{% url 'home' %}"; }, 1500);
            } else {
                throw new Error(result.error || 'Xatolik');
            }
        } catch (error) {
            console.error('Error:', error);
            statusMessage.textContent = `‚ùå Xatolik! Tekshiring yoki qayta yozing.`;
            statusMessage.classList.add('show', 'error');
        } finally {
            submitBtn.disabled = false;
            btnText.textContent = 'Yuborish';
        }
    });
</script>



{% endblock %}